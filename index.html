<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Character Collector Game</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" href="style.css">
</head>
<body class="bg-gradient-to-br from-blue-100 to-purple-100 min-h-screen">
	<!-- Start Screen -->
	<div id="start-screen" class="min-h-screen flex items-center justify-center p-4">
		<div class="max-w-4xl w-full">
			<!-- Title -->
			<div class="text-center mb-8">
				<h1 class="text-6xl font-bold text-purple-800 mb-4">Character Collector</h1>
				<p class="text-xl text-gray-700">Choose your characters and collect your prizes!</p>
			</div>

			<!-- Character Selection -->
			<div class="bg-white rounded-lg shadow-2xl p-6 mb-6">
				<h2 class="text-2xl font-semibold mb-4 text-gray-800 text-center">Select Characters</h2>
				
				<div class="grid md:grid-cols-2 gap-6">
					<!-- Player 1 Selection -->
					<div id="player1-box" class="border-4 border-gray-300 rounded-lg p-4 bg-gray-50 transition-all">
						<h3 id="player1-title" class="font-bold text-gray-600 mb-4 text-2xl text-center">Player 1</h3>
						<div class="flex flex-wrap gap-4 justify-center mb-4" id="player1-buttons">
							<!-- Character images will be dynamically generated from config.json -->
						</div>
						<div class="text-center">
							<div id="player1-selected" class="text-lg font-semibold text-gray-600 mb-2">Tap a character!</div>
							<div class="text-xs text-gray-500 mb-2">Controls: Arrow Keys or Gamepad 1</div>
							<button id="player1-deselect" onclick="deselectCharacter(0)" class="hidden px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-sm font-bold">
								Deselect Character
							</button>
						</div>
					</div>

					<!-- Player 2 Selection -->
					<div id="player2-box" class="border-4 border-gray-300 rounded-lg p-4 bg-gray-50 transition-all">
						<h3 id="player2-title" class="font-bold text-gray-600 mb-4 text-2xl text-center">Player 2</h3>
						<div class="flex flex-wrap gap-4 justify-center mb-4" id="player2-buttons">
							<!-- Character images will be dynamically generated from config.json -->
						</div>
						<div class="text-center">
							<div id="player2-selected" class="text-lg font-semibold text-gray-600 mb-2">Tap a character!</div>
							<div class="text-xs text-gray-500 mb-2">Controls: WASD Keys or Gamepad 2</div>
							<button id="player2-deselect" onclick="deselectCharacter(1)" class="hidden px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-sm font-bold">
								Deselect Character
							</button>
						</div>
					</div>
				</div>

				<!-- Game Mode Selection -->
				<div class="mb-4">
					<h3 class="text-lg font-semibold mb-3 text-gray-800 text-center">Game Mode</h3>
					<div class="flex flex-wrap gap-3 justify-center">
						<button onclick="selectGameMode('freeplay')" data-mode="freeplay" class="game-mode-btn px-6 py-3 bg-purple-200 rounded-lg hover:bg-purple-300 transition font-medium border-4 border-transparent">
							Free Play
						</button>
						<button onclick="selectGameMode('race')" data-mode="race" class="game-mode-btn px-6 py-3 bg-purple-200 rounded-lg hover:bg-purple-300 transition font-medium border-4 border-transparent">
							Race (First to 15)
						</button>
						<button onclick="selectGameMode('countdown')" data-mode="countdown" class="game-mode-btn px-6 py-3 bg-purple-200 rounded-lg hover:bg-purple-300 transition font-medium border-4 border-transparent">
							Countdown (60s)
						</button>
					</div>
				</div>

				<!-- Countdown Display -->
				<div id="selection-countdown" class="text-center mt-4 hidden"></div>
				
				<!-- Start Button -->
				<div class="text-center mt-6">
					<button id="start-button" onclick="startGame()" disabled class="px-8 py-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition text-xl font-bold disabled:bg-gray-400 disabled:cursor-not-allowed">
						Start Game
					</button>
				</div>
			</div>

			<!-- Gamepad Status -->
			<div id="gamepad-status" class="text-center text-sm text-gray-600"></div>
		</div>
	</div>

	<!-- Game Screen (Hidden Initially) -->
	<div id="game-screen" class="hidden fixed inset-0 bg-black">
		<!-- Game Canvas -->
		<canvas id="game" class="w-full h-full"></canvas>
		
		<!-- Game UI Overlay -->
		<div class="absolute top-4 left-4 right-4 flex justify-between items-start">
			<!-- Scores -->
			<div class="bg-black bg-opacity-50 text-white p-4 rounded-lg">
				<div class="text-lg font-bold mb-2"><span id="player1-score">Loading...</span></div>
				<div class="text-lg font-bold"><span id="player2-score">Loading...</span></div>
			</div>
			
			<!-- Game Mode UI (Center) -->
			<div id="game-mode-ui-container" class="bg-black bg-opacity-50 text-white p-4 rounded-lg hidden">
				<!-- Countdown Timer (for countdown mode) -->
				<div id="game-timer" class="text-3xl font-bold text-center hidden">60</div>
				
				<!-- Race Progress Bars (for race mode) -->
				<div id="race-progress" class="hidden">
					<div class="mb-2">
						<div class="text-sm mb-1">Player 1</div>
						<div class="w-64 h-6 bg-gray-700 rounded-full overflow-hidden">
							<div id="player1-progress" class="h-full bg-blue-500 transition-all duration-300" style="width: 0%"></div>
						</div>
					</div>
					<div>
						<div class="text-sm mb-1">Player 2</div>
						<div class="w-64 h-6 bg-gray-700 rounded-full overflow-hidden">
							<div id="player2-progress" class="h-full bg-green-500 transition-all duration-300" style="width: 0%"></div>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Exit Button -->
			<button onclick="requestExitGame()" class="bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition font-bold">
				Exit Game (ESC)
			</button>
			
			<!-- Exit Confirmation Modal -->
			<div id="exit-confirmation-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
				<div class="bg-white rounded-lg p-8 text-center max-w-md">
					<h2 class="text-3xl font-bold mb-4 text-gray-800">Exit Game?</h2>
					<p class="text-lg text-gray-600 mb-6">Are you sure you want to exit? Your progress will be lost.</p>
					<div class="flex gap-4 justify-center">
						<button onclick="confirmExitGame()" class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-lg font-bold">
							Yes, Exit
						</button>
						<button onclick="cancelExitGame()" class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition text-lg font-bold">
							Cancel
						</button>
					</div>
				</div>
			</div>
		</div>
		
		<!-- Game Over Overlay -->
		<div id="game-over-overlay" class="hidden absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center">
			<div class="bg-white rounded-lg p-8 text-center">
				<h2 id="game-over-title" class="text-4xl font-bold mb-4"></h2>
				<div id="game-over-scores" class="text-2xl mb-6"></div>
				<button onclick="exitGame()" class="px-8 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition text-xl font-bold">
					Back to Menu
				</button>
			</div>
		</div>
	</div>

	<!-- Hidden Images -->
	<div style="display:none;">
		<img id="moana" src="images/characters/moana.png" alt="Moana">
		<img id="heihei" src="images/characters/heihei.png" alt="Hei Hei">
		<img id="heart" src="images/prizes/heart.png" alt="Heart">
	</div>

	<script type="module" src="js/main.js"></script>
</body>
</html>
